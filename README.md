# 基于区块链的宠物管理系统

## 项目概述

本项目是一个基于区块链技术的宠物管理系统，旨在利用区块链的去中心化、不可篡改等特性，构建一个透明、安全、可信的宠物生命周期管理平台。系统支持宠物信息登记、健康状态追踪、领养流程管理、医疗记录存储等功能，并通过智能合约实现宠物所有权的安全转移和验证。

主要功能包括：

- **宠物信息管理**：登记、更新和查询宠物基本信息，包括品种、年龄、健康状态等
- **用户身份认证**：基于区块链钱包的用户注册和权限管理，支持个人用户和机构用户
- **机构管理**：宠物医院和救助站的注册、认证与人员管理
- **宠物领养市场**：发布、申请和处理领养请求，记录领养历史
- **医疗记录管理**：由医院机构记录和查询宠物医疗历史，确保数据真实性
- **救助请求处理**：发布和响应宠物救助需求，由救助站机构处理

## 系统架构

本系统采用前后端分离架构，结合区块链技术实现：

- **前端技术栈**：Next.js + React + TypeScript + MobX
- **区块链技术**：Ethereum + Solidity + Hardhat
- **存储方案**：IPFS分布式存储（用于宠物图片等非结构化数据）
- **钱包集成**：RainbowKit + wagmi（用于以太坊钱包连接和交互）

## 智能合约设计

系统核心由三个主要智能合约组成，它们相互协作实现完整的业务逻辑：

### InstitutionManager.sol

负责机构管理，包括：

- 医院和救助站的注册与认证
- 机构人员（员工）管理
- 机构信息更新和查询
- 机构负责人变更

### UserManager.sol

负责用户管理，包括：

- 用户注册与资料管理
- 用户角色分配（管理员、普通用户、医院人员、救助站人员）
- 用户与机构关联
- 用户宠物所有权记录

### PetManager.sol

负责宠物及相关事件管理，包括：

- 宠物信息登记与更新
- 宠物健康状态和领养状态管理
- 领养事件记录
- 医疗事件记录
- 救助请求处理

## 角色与权限

系统支持多种角色，每种角色拥有不同的权限：

- **管理员**：系统部署者，可以添加/删除机构，管理用户角色
- **普通用户**：可以注册宠物，查看和更新自己的宠物信息，参与领养
- **医院人员**：可以更新宠物健康状态，添加医疗记录
- **救助站人员**：可以更新宠物领养状态，处理救助请求，管理领养流程

## 核心功能实现

### 宠物生命周期管理

- 宠物注册：用户可以注册宠物，记录基本信息
- 健康状态追踪：医院可以更新宠物健康状态，添加医疗记录
- 领养流程：救助站可以发布可领养宠物，处理领养申请，记录领养历史

### 机构管理

- 机构注册：由管理员添加医院和救助站机构
- 人员管理：机构负责人可以添加和移除员工
- 机构信息更新：机构可以更新自身信息

### 用户系统

- 用户注册：用户通过区块链钱包地址注册
- 角色分配：根据用户类型和关联机构自动分配角色
- 资料管理：用户可以设置和更新个人资料

## 前端页面

系统包含多个功能页面：

- **首页**：系统概览和功能导航
- **个人资料**：用户信息管理
- **我的宠物**：用户宠物列表和管理
- **领养市场**：可领养宠物列表和申请
- **医疗记录**：宠物医疗历史查询
- **救助请求**：发布和查看救助请求
- **管理页面**：管理员专用功能

## 开发与部署

### 环境准备

```bash
# 安装依赖
npm install
```

### 本地开发

```bash
# 依次启动hardhat节点，部署合约，启动IPFS，启动前端
npm run hardhat
npm run compile
npm run ipfs
npm run dev
```

### 测试

```bash
# 运行合约测试
npm test
```

## 创新点

1. **区块链赋能宠物管理**：利用区块链不可篡改特性，确保宠物信息和所有权记录的真实性和可追溯性
2. **多角色协作机制**：通过智能合约实现个人用户、医院和救助站等多方协作的权限管理和流程控制
3. **IPFS分布式存储**：采用IPFS存储宠物图片等数据，提高系统的去中心化程度和数据持久性
4. **完整生命周期管理**：从宠物注册、医疗记录、救助到领养的全流程追踪

## 未来发展方向

1. **宠物芯片集成**：与实体宠物芯片技术集成，实现线上线下身份统一
2. **数据分析功能**：添加宠物健康数据分析和可视化功能
3. **多链支持**：支持多条区块链，降低Gas费用和提高交易速度
4. **社区功能**：增加宠物社区模块，促进用户交流和知识分享
5. **合约安全审计**：进行专业的智能合约安全审计，防止潜在漏洞

## 测试账号

部署合约账户：系统管理员  
Account #0: 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 (10000 ETH)  
Private Key: 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80

普通用户  
Account #1: 0x70997970C51812dc3A010C7d01b50e0d17dc79C8 (10000 ETH)  
Private Key: 0x59c6995e998f97a5a0044966f0945389dc9e86dae88c7a8412f4603b6b78690d

医院用户  
Account #2: 0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC (10000 ETH)  
Private Key: 0x5de4111afa1a4b94908f83103eb1f1706367c2e68ca870fc3fb9a804cdab365a

救助站用户
Account #4: 0x15d34AAf54267DB7D7c367839AAf71A00a2C6A65 (10000 ETH)  
Private Key: 0x47e179ec197488593b187f80a00eb0da91f1b9d0b13f8733639f19c30a34926a

Account #3: 0x90F79bf6EB2c4f870365E785982E1f101E93b906 (10000 ETH)  
Private Key: 0x7c852118294e51e653712a81e05800f419141751be58f605c371e15141b007a6

Account #5: 0x9965507D1a55bcC2695C58ba16FB37d819B0A4dc (10000 ETH)  
Private Key: 0x8b3a350cf5c34c9194ca85829a2df0ec3153be0318b5e2d3348e872092edffba

Account #6: 0x976EA74026E726554dB657fA54763abd0C3a0aa9 (10000 ETH)  
Private Key: 0x92db14e403b83dfe3df233f83dfa3a0d7096f21ca9b0d6d6b8d88b2b4ec1564e

Account #7: 0x14dC79964da2C08b23698B3D3cc7Ca32193d9955 (10000 ETH)  
Private Key: 0x4bbbf85ce3377467afe5d46f804f221813b2bb87f24d81f60f1fcdbf7cbf4356

Account #8: 0x23618e81E3f5cdF7f54C3d65f7FBc0aBf5B21E8f (10000 ETH)  
Private Key: 0xdbda1821b80551c9d65939329250298aa3472ba22feea921c0cf5d620ea67b97

Account #9: 0xa0Ee7A142d267C1f36714E4a8F75612F20a79720 (10000 ETH)  
Private Key: 0x2a871d0798f97d79848a013d4936a73bf4cc922c825d33c1cf7073dff6d409c6

Account #10: 0xBcd4042DE499D14e55001CcbB24a551F3b954096 (10000 ETH)  
Private Key: 0xf214f2b2cd398c806f84e317254e0f0b801d0643303237d97a22a48e01628897
